<div class="modal-header">
    <h4 class="modal-title pull-left">{{ user.username }}</h4>
    <button
        type="button"
        class="btn-close close pull-right"
        aria-label="close-btn"
        [disabled]="isLoadingEditUser || isLoadingChangePassword"
        (click)="bsModalRef.hide()"
    >
        <span
            aria-hidden="true"
            class="visually-hidden"
        >
            &times;
        </span>
    </button>
</div>
<div class="modal-body">
    <form [formGroup]="editUserForm">
        <ww-input
            id="username-edit"
            label="Username"
            formControlName="Username"
            [validState]="validationService.checkFieldValidity(editUserForm, 'Username')"
            validatorMessage="Please enter between 6 and 40 characters"
        />
        <ww-radio
            id="defaultAutocomplete"
            label="Automatically close tasks when the limit of subtasks or counters is reached"
            formControlName="AutoCompleteTasks"
            [options]="defaultAutocompleteOptions"
            [type]="ElementType.Primary"
            [size]="ElementSize.Medium"
            [outline]="true"
        ></ww-radio>
        <ww-radio
            id="theme"
            label="Interface color theme"
            formControlName="Theme"
            [options]="themeOptions"
            [type]="ElementType.Primary"
            [size]="ElementSize.Medium"
            [outline]="true"
        ></ww-radio>
        <div class="user-modal-edit-buttons">
            <ww-preloader
                *ngIf="isLoadingEditUser"
                class="user-modal-preloader"
                [small]="true"
            ></ww-preloader>
            <ww-button
                label="Edit user data"
                [size]="ElementSize.Medium"
                [type]="ElementType.Primary"
                [disabled]="isLoadingEditUser || isLoadingChangePassword"
                (clicked)="editUser()"
            />
        </div>
    </form>
    <form [formGroup]="changePasswordForm">
        <ww-input
            id="pass-old-edit"
            label="Old password"
            type="password"
            formControlName="OldPassword"
            [validState]="validationService.checkFieldValidity(changePasswordForm, 'OldPassword')"
            validatorMessage="Please enter between 6 and 40 characters"
        />
        <ww-input
            id="pass-edit"
            label="Password"
            type="password"
            formControlName="NewPassword"
            [validState]="validationService.checkFieldValidity(changePasswordForm, 'NewPassword')"
            validatorMessage="Please enter between 6 and 40 characters"
        />
        <ww-input
            id="pass-again-edit"
            label="Repeat new password"
            type="password"
            formControlName="RepeatPassword"
            [validState]="validationService.checkPasswordMatch(changePasswordForm, 'RepeatPassword')"
            validatorMessage="Both passwords must be the same"
        />
    </form>
</div>
<div class="modal-footer">
    <ww-preloader
        *ngIf="isLoadingChangePassword"
        class="user-modal-preloader"
        [small]="true"
    ></ww-preloader>
    <ww-button
        label="Close"
        [size]="ElementSize.Medium"
        [type]="ElementType.Light"
        [disabled]="isLoadingEditUser || isLoadingChangePassword"
        (clicked)="bsModalRef.hide()"
    />
    <ww-button
        label="Change password"
        [size]="ElementSize.Medium"
        [type]="ElementType.Primary"
        [disabled]="isLoadingEditUser || isLoadingChangePassword"
        (clicked)="changePassword()"
    />
</div>
